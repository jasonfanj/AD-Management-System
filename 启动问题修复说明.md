# 启动问题修复说明

## 问题原因

服务启动失败是因为 **SQLAlchemy 版本兼容性问题**：
- Python 3.14.2 是最新版本
- SQLAlchemy 2.0.23 与 Python 3.14 存在兼容性问题
- 错误信息：`AssertionError: Class SQLCoreOperations directly inherits TypingOnly but has additional attributes`

## 解决方案

已升级 SQLAlchemy 到 **2.0.45** 版本，该版本支持 Python 3.14。

## 修复步骤

1. ✅ 升级 SQLAlchemy：
   ```powershell
   venv\Scripts\python.exe -m pip install --upgrade SQLAlchemy
   ```

2. ✅ 更新 requirements.txt：
   - 将 `SQLAlchemy==2.0.23` 改为 `SQLAlchemy>=2.0.23,<3.0.0`
   - 允许自动使用兼容的更新版本

## 现在可以启动

运行启动脚本：

```powershell
.\start.bat
```

或：

```powershell
.\启动.ps1
```

## 验证修复

如果看到以下输出，说明启动成功：

```
============================================================
域控通-Web AD管理系统
============================================================
初始化数据库...
✓ 默认管理员账户已创建: admin / admin123
后端服务启动中...
API地址: http://localhost:5000/api
前端地址: 直接打开 frontend/index.html 文件
默认账户: admin / admin123
============================================================
 * Running on http://0.0.0.0:5000
```

## 如果仍有问题

1. **重新安装依赖**：
   ```powershell
   .\install.bat
   ```

2. **检查 Python 版本**：
   ```powershell
   python --version
   ```
   建议使用 Python 3.11 或 3.12（更稳定）

3. **清理虚拟环境重新安装**：
   ```powershell
   Remove-Item -Recurse -Force venv
   .\install.bat
   ```

## 注意事项

- Python 3.14 是最新版本，某些库可能还未完全支持
- 如果遇到其他兼容性问题，建议使用 Python 3.11 或 3.12
- SQLAlchemy 2.0.45 已修复 Python 3.14 兼容性问题

